<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml"
                template="#{LayoutMB.layout}"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="titleOfPage">
        Clientes
    </ui:define>

    <ui:define name="content">
        <h:form prependId="false"
                id="form">

            <div style="margin-bottom: 10px;">
                <h1>
                    Clientes
                </h1>
            </div>
            
            <p:messages autoUpdate="true"/>

            <h:panelGroup id="filtrosGroup">
                <h:panelGroup rendered="#{ClienteCrudMB.filtros.exibirFiltro}">
                    <div class="box box-primary">
                        <div class="box-header with-border">


                            <div class="ui-g ui-fluid">
                                <div >
                                    <p:outputLabel value="Nome:" for="inptNome"/>
                                </div>
                                <div >
                                    <p:inputText id="inptNome" 
                                                 value="#{ClienteCrudMB.filtros.nome}" 
                                                 label="Nome"/>
                                </div>
                                <div >
                                    <p:commandButton actionListener="#{ClienteCrudMB.filtros.limparFiltros()}"
                                                     icon="fa fa-eraser"
                                                     value="Limpar" 
                                                     update="filtrosGroup"
                                                     class="btn btn-xs btn-default"/>
                                </div>
                                <div >
                                    <p:commandButton actionListener="#{ClienteCrudMB.filtros.filtrar()}"
                                                     icon="fa fa-search"
                                                     value="Buscar" 
                                                     update="dataTable"
                                                     class="btn btn-xs btn-primary"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </h:panelGroup>
            </h:panelGroup>

            <div class="box box-primary">
                <div class="box-header with-border">
                    <p:commandButton action="form?faces-redirect=true" 
                                     ajax="false" 
                                     icon="fa fa-plus"
                                     class="btn btn-xs btn-primary"
                                     value="Novo" />

                    <p:spacer width="5"/>

                    <p:commandButton value="Excluir Selecionado(s)"
                                     icon="fa fa-trash" 
                                     actionListener="#{ClienteCrudMB.delete()}"
                                     class="btn btn-xs btn-danger"
                                     process="@form"
                                     update="@form">
                        <p:confirm header="Remover"
                                   message="Deseja remover esse(s) cliente(s)?" 
                                   icon="ui-icon-alert" />
                    </p:commandButton>

                    <p:spacer width="5"/>

                    <p:commandButton id="btnFind"
                                     value="#{ClienteCrudMB.filtros.exibirFiltro ? 'Esconder' : 'Exibir'} Filtros"
                                     process="@form"
                                     actionListener="#{ClienteCrudMB.filtros.setExibirFiltro(!ClienteCrudMB.filtros.exibirFiltro)}"
                                     update="filtrosGroup, @this"
                                     icon="fa fa-search" 
                                     class="btn btn-xs btn-default"
                                     partialSubmit="true"/>

                    <p:separator/>

                    <p:dataTable id="dataTable"
                                 var="item"  
                                 rows="25" 
                                 paginator="true"
                                 pageLinks="5" 
                                 rowsPerPageTemplate="25,50,100"
                                 currentPageReportTemplate="Exibindo: {startRecord}-{endRecord} de {totalRecords} Registros"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 paginatorPosition="bottom"
                                 value="#{ClienteCrudMB.lazyDataModel}" 
                                 selection="#{ClienteCrudMB.itensSelecionados}"
                                 widgetVar="dataTableVar"
                                 reflow="true"
                                 emptyMessage="Nenhum registro encontrado"
                                 lazy="true">


                        <p:column selectionMode="multiple" width="5%" style="text-align: center;"/>

                        <p:column id="id" 
                                  width="5%"
                                  style="text-align: center;"
                                  exportable="true"
                                  sortBy="#{item.id}"
                                  headerText="#">
                            <p:link value="#{item.id}" 
                                    outcome="form.xhtml" >
                                <f:param name="id" value="#{item.id}"/>
                            </p:link>
                        </p:column>

                        <p:column id="nome" 
                                  exportable="true"
                                  sortBy="#{item.nome}"
                                  headerText="Nome">
                            <h:outputText value="#{item.nome}" />
                        </p:column>
                        
                        <p:column id="cpf" 
                                  exportable="true"
                                  sortBy="#{item.cpf}"
                                  headerText="Cpf">
                            <h:outputText value="#{item.cpf}" />
                        </p:column>

                        <p:column id="email" 
                                  exportable="true"
                                  sortBy="#{item.email}"
                                  headerText="Email">
                            <h:outputText value="#{item.email}" />
                        </p:column>
                        
                        <p:column id="telefone" 
                                  exportable="true"
                                  sortBy="#{item.telefone1}"
                                  headerText="Telefone">
                            <h:outputText value="#{item.telefone1}" />
                        </p:column>

                        
                    </p:dataTable>

                </div>
            </div>

            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                <p:commandButton value="NÃ£o" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
            </p:confirmDialog>

        </h:form>
    </ui:define>

</ui:composition>
